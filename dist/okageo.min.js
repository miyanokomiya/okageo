/*!
 * okageo v1.1.6
 * (c) miyanokomiya
 * Released under the MIT License.
 */
"use strict";var tslib=require("tslib"),MINVALUE=1e-6;function add(e,t){return{x:e.x+t.x,y:e.y+t.y}}function sub(e,t){return{x:e.x-t.x,y:e.y-t.y}}function multi(e,t){return{x:e.x*t,y:e.y*t}}function isSame(e,t){var r=sub(e,t);return Math.abs(r.x)<MINVALUE&&Math.abs(r.y)<MINVALUE}function getDistance(e,t){var r=sub(e,t);return Math.sqrt(r.x*r.x+r.y*r.y)}function getNorm(e){return getDistance(e,{x:0,y:0})}function isZero(e){return getNorm(e)<MINVALUE}function getUnit(e){var t=getNorm(e);if(t<MINVALUE)throw new Error("cannot get unit vector of zero vector");return multi(e,1/t)}function getCross(e,t){return e.x*t.y-e.y*t.x}function getInner(e,t){return e.x*t.x+e.y*t.y}function cloneVectors(e){return e.map(function(e){return tslib.__assign({},e)})}function getCenter(e,t){return multi(add(e,t),.5)}function getRadian(e,t){void 0===t&&(t={x:0,y:0});var r=sub(e,t);return Math.atan2(r.y,r.x)}function getSymmetry(e,t){return void 0===t&&(t={x:0,y:0}),add(multi(sub(t,e),2),e)}function rotate(e,t,r){void 0===r&&(r={x:0,y:0});var a=sub(e,r);return add({x:Math.cos(t)*a.x-Math.sin(t)*a.y,y:Math.sin(t)*a.x+Math.cos(t)*a.y},r)}function solveEquationOrder2(e,t,r){if(0===e)return 0===t?[]:[-r/t];var a=t*t-4*e*r;if(a<0)return[];var n=.5/e;if(0===a)return[-t*n];var i=Math.sqrt(a);return[(-t+i)*n,(-t-i)*n]}function getPedal(e,t){if(2!==t.length)throw new Error("line must be length = 2");var r=t[0],a=sub(t[1],r);return add(r,multi(a,getInner(a,sub(e,r))/getInner(a,a)))}function rayToBezier(e,t,r,a,n){var i=n.x-a.x,s=n.y-a.y,o=e.x-2*t.x+r.x,l=2*(t.x-e.x),u=e.x,c=e.y-2*t.y+r.y,p=2*(t.y-e.y),g=e.y;return solveEquationOrder2(o*s-i*c,l*s-i*p,s*u-s*a.x-i*g+i*a.y)}function getCrossLineAndBezier(e,t,r,a,n){return rayToBezier(e,t,r,a,n).filter(function(e){return 0<=e&&e<=1}).map(function(a){return{x:(r.x-2*t.x+e.x)*a*a+2*(t.x-e.x)*a+e.x,y:(r.y-2*t.y+e.y)*a*a+2*(t.y-e.y)*a+e.y}})}function isCrossSegAndSeg(e,t){var r=getCrossSegAndSegParams(e,t),a=r.ta,n=r.tb;return r.tc*r.td<0&&a*n<0}function isTouchSegAndSeg(e,t){var r=getCrossSegAndSegParams(e,t),a=r.ta,n=r.tb;return r.tc*r.td<=0&&a*n<=0}function getCrossSegAndSegParams(e,t){var r=e[0].x,a=e[0].y,n=e[1].x,i=e[1].y,s=t[0].x,o=t[0].y,l=t[1].x,u=t[1].y;return{ta:(s-l)*(a-o)+(o-u)*(s-r),tb:(s-l)*(i-o)+(o-u)*(s-n),tc:(r-n)*(o-a)+(a-i)*(r-s),td:(r-n)*(u-a)+(a-i)*(r-l)}}function isParallel(e,t){var r=getCross(e,t);return Math.abs(r)<MINVALUE}function isOnLine(e,t){return isZero(sub(e,getPedal(e,t)))}function isOnSeg(e,t){if(!isZero(sub(e,getPedal(e,t))))return!1;var r=sub(t[1],t[0]),a=sub(e,t[0]);return!(getInner(r,a)<0)&&!(getNorm(r)<getNorm(a))}function isCrossSegAndRightHorizon(e,t){if(Math.abs(t[0].y-t[1].y)<MINVALUE)return!1;var r,a;if(t[0].y<t[1].y?(a=t[0],r=t[1]):(r=t[0],a=t[1]),e.y<a.y||r.y<=e.y)return!1;var n=getCrossSegAndLine(t,[e,{x:e.x+1,y:e.y}]);return!(!n||n.x<=e.x)}function isOnPolygon(e,t){if(t.find(function(t){return e.x===t.x&&e.y===t.y}))return!0;for(var r=t.map(function(e,r){return[e,r<t.length-1?t[r+1]:t[0]]}).filter(function(e){return!isSame(e[0],e[1])}),a=0;a<r.length;a++){var n=r[a];if(isOnSeg(e,n))return!0}return r.filter(function(t){return isCrossSegAndRightHorizon(e,t)}).length%2==1}function getCrossSegAndLine(e,t){if(isParallel(sub(e[0],e[1]),sub(t[0],t[1])))return null;if(isOnLine(e[0],t))return tslib.__assign({},e[0]);if(isOnLine(e[1],t))return tslib.__assign({},e[1]);var r=((t[1].x-t[0].x)*(e[0].y-t[0].y)-(t[1].y-t[0].y)*(e[0].x-t[0].x))/2,a=r/(r+((t[1].x-t[0].x)*(t[0].y-e[1].y)-(t[1].y-t[0].y)*(t[0].x-e[1].x))/2);return 0<a&&a<1?{x:e[0].x+(e[1].x-e[0].x)*a,y:e[0].y+(e[1].y-e[0].y)*a}:null}function isSameSeg(e,t){return!(!isSame(e[0],t[0])||!isSame(e[1],t[1]))||!(!isSame(e[0],t[1])||!isSame(e[1],t[0]))}function splitPolyByLine(e,t){var r=[],a=[],n=[];if(e.forEach(function(i,s){var o=getCrossSegAndLine([i,e[(s+1)%e.length]],t);r.push(i),o&&(r.push(o),a.push(s+1+a.length),n.push(o))}),a.length%2!=0)return[];var i=getRadian(t[0],t[1]);n.sort(function(e,t){return rotate(e,-i).x-rotate(t,-i).x});for(var s=[],o=0;o<n.length-1;o+=2){for(var l=[n[o],n[o+1]],u=!1,c=0;c<e.length;c++)if(isSameSeg(l,[e[c],e[(c+1)%e.length]])){u=!0;break}if(!u){s=l;break}}if(2!==s.length)return[];var p=n.concat(),g=p.indexOf(s[0]);-1!==g&&p.splice(g,1),-1!==(g=p.indexOf(s[1]))&&p.splice(g,1);var f=r.concat();p.forEach(function(e){var t=f.indexOf(e);f.splice(t,1)}),n=s;var y=(r=f).indexOf(n[0]),h=r.indexOf(n[1]);if(-1===y||-1===h)return[];(a=[])[0]=Math.min(y,h),a[1]=Math.max(y,h);for(var x=[],m=[],v=0;v<=a[0];v++)m.push({x:r[v].x,y:r[v].y});for(v=a[1];v<r.length;v++)m.push({x:r[v].x,y:r[v].y});x.push(m),m=[];for(v=a[0];v<=a[1];v++)m.push({x:r[v].x,y:r[v].y});x.push(m);var S=[];return x.forEach(function(e){var r=splitPolyByLine(e,t);0===r.length?S.push(e):S.push.apply(S,r)}),S}function triangleSplit(e){for(var t=omitSamePoint(e=convertLoopwise(e)),r=0,a=0,n=[];t.length>=3;){var i=t.concat();i.sort(function(e,t){return getNorm(t)-getNorm(e)}),r=t.indexOf(i[0]);var s=getTriangle(t,r);if(s)t.splice(r,1);else{var o=t.length;a=getCross(sub(t[(r+1)%o],t[r]),sub(t[r-1<0?o-1:r-1],t[r]));for(var l=r;!s;){if(getCross(sub(t[((l=(l+1)%o)+1)%o],t[l]),sub(t[l-1<0?o-1:l-1],t[l]))*a>0&&(s=getTriangle(t,l)),l===r)throw new Error("failed to split triangles")}t.splice(l,1)}n.push(s)}return n}function getTriangle(e,t){var r=e.length,a=e[t],n=e[(t+1)%r],i=e[t-1<0?r-1:t-1],s=[a,n,i],o=!1;return e.some(function(e){return e!==a&&e!==n&&e!==i&&isPointOnTriangle(s,e)&&(o=!0),o}),o?null:s}function isPointOnTriangle(e,t){var r=sub(e[1],e[0]),a=sub(e[2],e[1]),n=sub(e[0],e[2]),i=sub(t,e[0]),s=sub(t,e[1]),o=sub(t,e[2]),l=getCross(r,s),u=getCross(a,o),c=getCross(n,i);return l>=0&&u>=0&&c>=0||l<=0&&u<=0&&c<=0}function convertLoopwise(e){var t=e.concat();return-1===getLoopwise(e)&&t.reverse(),t}function getLoopwise(e){var t=getArea(e,!0);return t>0?1:t<0?-1:0}function getArea(e,t){if(void 0===t&&(t=!1),e.length<3)return 0;for(var r=0,a=e.length,n=0;n<a-1;n++)r+=(e[n].x-e[n+1].x)*(e[n].y+e[n+1].y);return r+=(e[a-1].x-e[0].x)*(e[a-1].y+e[0].y),r/=2,t||(r=Math.abs(r)),r}function approximateBezier(e,t){var r=[],a=1/t;if(3===e.length)for(var n=0;n<=t;n++){var i=a*n,s=multi(e[0],(1-i)*(1-i)),o=multi(e[1],2*i*(1-i)),l=multi(e[2],i*i);r.push({x:s.x+o.x+l.x,y:s.y+o.y+l.y})}else{if(4!==e.length)throw new Error("connot approximate");for(n=0;n<=t;n++){i=a*n,s=multi(e[0],(1-i)*(1-i)*(1-i)),o=multi(e[1],3*i*(1-i)*(1-i)),l=multi(e[2],3*i*i*(1-i));var u=multi(e[3],i*i*i);r.push({x:s.x+o.x+l.x+u.x,y:s.y+o.y+l.y+u.y})}}return r}function approximateArc(e,t,r,a,n,i,s){for(var o=[],l=(a-r)/s,u=0;u<=s;u++){var c=l*u+r-i;o.push(add(rotate({x:e*Math.cos(c),y:t*Math.sin(c)},i),n))}return o}function approximateArcWithPoint(e,t,r,a,n,i,s,o){if(e*t==0)return[r,a];var l=getEllipseCenter(r,a,e=Math.abs(e),t=Math.abs(t),s),u=l.centers;e*=l.radiusRate,t*=l.radiusRate;var c=null,p=0,g=0,f=getRadianOnArc(r,e,c=n&&i||!n&&!i?getLoopwise([r,a,u[0]])<0?u[0]:u[1]:getLoopwise([r,a,u[0]])>0?u[0]:u[1],s),y=getRadianOnArc(a,e,c,s);return i?f>y?(p=f-2*Math.PI,g=y):(p=f,g=y):f>y?(p=f,g=y):(p=f,g=y-2*Math.PI),approximateArc(e,t,p,g,c,s,o)}function getRadianOnArc(e,t,r,a){e=rotate(e,-a,r);var n=Math.acos((e.x-r.x)/t);return e.y-r.y<0&&(n=-n+2*Math.PI),n+=a,n%=2*Math.PI}function getEllipseCenter(e,t,r,a,n){e=rotate(e,-n),t=rotate(t,-n);var i=getCircleCenter({x:e.x/r,y:e.y/a},{x:t.x/r,y:t.y/a},1),s=i.centers,o={x:s[0].x*r,y:s[0].y*a},l={x:s[1].x*r,y:s[1].y*a};return{centers:[o=rotate(o,n),l=rotate(l,n)],radiusRate:i.radiusRate}}function getCircleCenter(e,t,r){var a=(e.x+t.x)/2,n=(e.x-t.x)/2,i=(e.y+t.y)/2,s=(e.y-t.y)/2,o=Math.sqrt(n*n+s*s),l=Math.pow(r/o,2)-1;if(l<0){var u=getCenter(e,t);return{centers:[u,u],radiusRate:o/r}}var c=Math.sqrt(l);return{centers:[{x:a+s*c,y:i-n*c},{x:a-s*c,y:i+n*c}],radiusRate:1}}function transform(e,t){var r=t[0],a=t[1],n=t[2],i=t[3],s=t[4],o=t[5];return e.map(function(e){return{x:r*e.x+n*e.y+s,y:a*e.x+i*e.y+o}})}function omitSamePoint(e){for(var t=e.concat(),r=e.length,a=0;a<r;a++){if(isSame(t[a],t[(a+1)%r])){t.splice(a,1),t=omitSamePoint(t);break}}return t}function getRegularPolygonArea(e,t){var r=Math.PI/t;return Math.pow(e,2)*Math.sin(r)*Math.cos(r)*t}function getRegularPolygonRadius(e,t){var r=Math.PI/t,a=e/t;return Math.sqrt(a/Math.sin(r)/Math.cos(r))}function getIncludedPolygonGroups(e){var t=e.concat();t.sort(function(e,t){return getArea(t)-getArea(e)});var r={},a=[];return t.forEach(function(e,n){if(!r[n]){r[n]=!0;var i=[e].concat(t.filter(function(t,a){return!r[a]&&(t.filter(function(t){return isOnPolygon(t,e)}).length===t.length&&(r[a]=!0,!0))}));a.push(i)}}),a}function getPolygonNotPolygon(e,t){for(var r=[],a=-1,n=[],i=[],s=0;s<e.length;s++){for(var o=[e[s],e[(s+1)%e.length]],l=0;l<t.length;l++){var u=[t[l],t[(l+1)%t.length]];if(isCrossSegAndSeg(o,u)){var c=getCrossSegAndLine(o,u);c&&(a=s,n.push(l),i.push(c))}}if(-1!==a)break}if(-1===a)return e;if(n.length%2!=0)return e;var p=i.map(function(t){return getDistance(t,e[a])}),g=p.concat().sort(function(e,t){return e-t}),f=p.indexOf(g[0]),y=n[f],h=t.concat();for(l=0;l<y;l++)h.push(h.shift());for(var x=n.map(function(e){return(e-y+t.length)%t.length}),m=i.concat(),v=0;v<f;v++)x.push(x.shift()),m.push(m.shift());for(s=0;s<e.length;s++)r.push(e[(s+a+1)%e.length]);for(s=0;s<x.length/2;s++){var S=x[2*s],d=x[2*s+1];r.push(m[2*s]);for(l=S+1;l<=d;l++)r.push(h[l]);r.push(m[2*s+1])}return r}var geo=Object.freeze({MINVALUE:MINVALUE,add:add,sub:sub,multi:multi,isSame:isSame,getDistance:getDistance,getNorm:getNorm,isZero:isZero,getUnit:getUnit,getCross:getCross,getInner:getInner,cloneVectors:cloneVectors,getCenter:getCenter,getRadian:getRadian,getSymmetry:getSymmetry,rotate:rotate,solveEquationOrder2:solveEquationOrder2,getPedal:getPedal,getCrossLineAndBezier:getCrossLineAndBezier,isCrossSegAndSeg:isCrossSegAndSeg,isTouchSegAndSeg:isTouchSegAndSeg,isParallel:isParallel,isOnLine:isOnLine,isOnSeg:isOnSeg,isOnPolygon:isOnPolygon,getCrossSegAndLine:getCrossSegAndLine,isSameSeg:isSameSeg,splitPolyByLine:splitPolyByLine,triangleSplit:triangleSplit,isPointOnTriangle:isPointOnTriangle,convertLoopwise:convertLoopwise,getLoopwise:getLoopwise,getArea:getArea,approximateBezier:approximateBezier,approximateArc:approximateArc,approximateArcWithPoint:approximateArcWithPoint,getEllipseCenter:getEllipseCenter,getCircleCenter:getCircleCenter,transform:transform,omitSamePoint:omitSamePoint,getRegularPolygonArea:getRegularPolygonArea,getRegularPolygonRadius:getRegularPolygonRadius,getIncludedPolygonGroups:getIncludedPolygonGroups,getPolygonNotPolygon:getPolygonNotPolygon}),configs={bezierSplitSize:10,ellipseSplitSize:20};function draw(e,t){e.lineCap=t.style.lineCap,e.lineJoin=t.style.lineJoin,e.beginPath(),t.d.forEach(function(t,r){0===r?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y)}),e.closePath(),t.included&&t.included.forEach(function(t){t.forEach(function(t,r){0===r?e.moveTo(t.x,t.y):e.lineTo(t.x,t.y)}),e.closePath()}),t.style.fill&&(e.fillStyle=t.style.fillStyle,e.globalAlpha=t.style.fillGlobalAlpha,e.fill()),t.style.stroke&&(e.strokeStyle=t.style.strokeStyle,e.globalAlpha=t.style.strokeGlobalAlpha,e.lineWidth=t.style.lineWidth,e.setLineDash(t.style.lineDash),e.stroke()),e.globalAlpha=1}function fitRect(e,t,r,a,n){var i=1/0,s=-1/0,o=1/0,l=-1/0;e.forEach(function(e){e.d.forEach(function(e){i=Math.min(i,e.x),s=Math.max(s,e.x),o=Math.min(o,e.y),l=Math.max(l,e.y)})});var u=e.map(function(e){return tslib.__assign(tslib.__assign({},e),{d:e.d.map(function(e){return{x:e.x-i,y:e.y-o}})})}),c=s-i,p=l-o,g=a/c,f=n/p,y=Math.min(g,f),h=u.map(function(e){return tslib.__assign(tslib.__assign({},e),{d:e.d.map(function(e){return{x:e.x*y,y:e.y*y}})})}),x=t+(a-c*y)/2,m=r+(n-p*y)/2;return h.map(function(e){return tslib.__assign(tslib.__assign({},e),{d:e.d.map(function(e){return{x:e.x+x,y:e.y+m}}),included:(e.included||[]).map(function(e){return e.map(function(e){return{x:(e.x-i)*y+x,y:(e.y-o)*y+m}})})})})}function parseSvgGraphicsStr(e){var t=(new DOMParser).parseFromString(e,"image/svg+xml").getElementsByTagName("svg");return t&&0!==t.length?parseSvgGraphics(t[0]):[]}function parseSvgGraphics(e){for(var t=[],r=e.getElementsByTagName("path"),a=0;a<r.length;a++){var n=r[a];t.push({d:parsePath(n),style:parseTagStyle(n)})}var i=e.getElementsByTagName("rect");for(a=0;a<i.length;a++){n=i[a];t.push({d:parseRect(n),style:parseTagStyle(n)})}var s=e.getElementsByTagName("ellipse");for(a=0;a<s.length;a++){n=s[a];t.push({d:parseEllipse(n),style:parseTagStyle(n)})}var o=e.getElementsByTagName("circle");for(a=0;a<o.length;a++){n=o[a];t.push({d:parseCircle(n),style:parseTagStyle(n)})}return t}function openCommandToD(e){var t=e.type;return"x1"in e&&(t+=" "+e.x1),"y1"in e&&(t+=" "+e.y1),"x2"in e&&(t+=" "+e.x2),"y2"in e&&(t+=" "+e.y2),"x3"in e&&(t+=" "+e.x3),"y3"in e&&(t+=" "+e.y3),"x"in e&&(t+=" "+e.x),"y"in e&&(t+=" "+e.y),t}function parseOpenPath(e){var t=[],r="";return e.commands.forEach(function(e){if((r+=openCommandToD(e)+" ")&&"Z"===e.type.toUpperCase()){var a=parsePathD(r);t.push({d:a,style:tslib.__assign(tslib.__assign({},createStyle()),{fill:!0,fillStyle:"black",stroke:!1})}),r=""}}),t}function parsePathD(e){var t=[],r=splitD(e),a={x:0,y:0},n={x:0,y:0};return r.forEach(function(e){var r=[],i=null,s=null;switch(e[0]){case"M":case"L":r.push({x:parseFloat(e[1]),y:parseFloat(e[2])});break;case"m":case"l":r.push({x:a.x+parseFloat(e[1]),y:a.y+parseFloat(e[2])});break;case"H":r.push({x:parseFloat(e[1]),y:a.y});break;case"V":r.push({x:a.x,y:parseFloat(e[1])});break;case"h":r.push({x:a.x+parseFloat(e[1]),y:a.y});break;case"v":r.push({x:a.x,y:a.y+parseFloat(e[1])});break;case"Q":(r=approximateBezier([i=a,s={x:parseFloat(e[1]),y:parseFloat(e[2])},{x:parseFloat(e[3]),y:parseFloat(e[4])}],configs.bezierSplitSize)).shift();break;case"q":(r=approximateBezier([i=a,s={x:i.x+parseFloat(e[1]),y:i.y+parseFloat(e[2])},{x:i.x+parseFloat(e[3]),y:i.y+parseFloat(e[4])}],configs.bezierSplitSize)).shift();break;case"T":(r=approximateBezier([i=a,s=getSymmetry(i,n),{x:parseFloat(e[1]),y:parseFloat(e[2])}],configs.bezierSplitSize)).shift();break;case"t":(r=approximateBezier([i=a,s=getSymmetry(i,n),{x:i.x+parseFloat(e[1]),y:i.y+parseFloat(e[2])}],configs.bezierSplitSize)).shift();break;case"C":(r=approximateBezier([i=a,s={x:parseFloat(e[1]),y:parseFloat(e[2])},{x:parseFloat(e[3]),y:parseFloat(e[4])},{x:parseFloat(e[5]),y:parseFloat(e[6])}],configs.bezierSplitSize)).shift();break;case"c":(r=approximateBezier([i=a,s={x:i.x+parseFloat(e[1]),y:i.y+parseFloat(e[2])},{x:i.x+parseFloat(e[3]),y:i.y+parseFloat(e[4])},{x:i.x+parseFloat(e[5]),y:i.y+parseFloat(e[6])}],configs.bezierSplitSize)).shift();break;case"S":(r=approximateBezier([i=a,s=getSymmetry(i,n),{x:parseFloat(e[1]),y:parseFloat(e[2])},{x:parseFloat(e[3]),y:parseFloat(e[4])}],configs.bezierSplitSize)).shift();break;case"s":(r=approximateBezier([i=a,s=getSymmetry(i,n),{x:i.x+parseFloat(e[1]),y:i.y+parseFloat(e[2])},{x:i.x+parseFloat(e[3]),y:i.y+parseFloat(e[4])}],configs.bezierSplitSize)).shift();break;case"A":i=a,s={x:parseFloat(e[6]),y:parseFloat(e[7])},(r=approximateArcWithPoint(parseFloat(e[1]),parseFloat(e[2]),i,s,!!parseInt(e[4],10),!!parseInt(e[5],10),parseFloat(e[3])/180*Math.PI,configs.bezierSplitSize)).shift();break;case"a":s={x:(i=a).x+parseFloat(e[6]),y:i.y+parseFloat(e[7])},(r=approximateArcWithPoint(parseFloat(e[1]),parseFloat(e[2]),i,s,!!parseInt(e[4],10),!!parseInt(e[5],10),parseFloat(e[3])/180*Math.PI,configs.bezierSplitSize)).shift()}r.length>0&&(a=r[r.length-1],t=t.concat(r),r.length>1&&(n=r[r.length-2]))}),t}function parsePath(e){var t=e.getAttribute("d");return t?adoptTransform(e.getAttribute("transform"),parsePathD(t)):[]}function parseRect(e){var t=[],r=parseFloat(e.getAttribute("x")||"0"),a=parseFloat(e.getAttribute("y")||"0"),n=parseFloat(e.getAttribute("width")||"0"),i=parseFloat(e.getAttribute("height")||"0");return t.push({x:r,y:a}),t.push({x:r+n,y:a}),t.push({x:r+n,y:a+i}),t.push({x:r,y:a+i}),t=adoptTransform(e.getAttribute("transform"),t)}function parseEllipse(e){var t=[],r=parseFloat(e.getAttribute("cx")||"0"),a=parseFloat(e.getAttribute("cy")||"0");return t=approximateArc(parseFloat(e.getAttribute("rx")||"1"),parseFloat(e.getAttribute("ry")||"1"),0,2*Math.PI,{x:r,y:a},0,configs.ellipseSplitSize),t=adoptTransform(e.getAttribute("transform"),t)}function parseCircle(e){var t=[],r=parseFloat(e.getAttribute("cx")||"0"),a=parseFloat(e.getAttribute("cy")||"0"),n=parseFloat(e.getAttribute("r")||"1");return t=approximateArc(n,n,0,2*Math.PI,{x:r,y:a},0,configs.ellipseSplitSize),t=adoptTransform(e.getAttribute("transform"),t)}function adoptTransform(e,t){if(!e)return t;var r=cloneVectors(t);return e.split(/\)/).forEach(function(e){var t=e.split(/\(/);if(2===t.length){var a=t[0],n=[];switch(t[1].split(/,/).forEach(function(e){return n.push(parseFloat(e))}),a.trim().toLowerCase()){case"matrix":r=transform(r,n);break;case"translate":r=r.map(function(e){return{x:e.x+n[0],y:e.y+n[1]}});break;case"scale":var i=n[0],s=n[0];n.length>1&&(s=n[1]),r=r.map(function(e){return{x:e.x*i,y:e.y*s}});break;case"rotate":var o={x:0,y:0};n.length>2&&(o={x:n[1],y:n[2]}),r=r.map(function(e){return rotate(e,n[0]*Math.PI/180,o)});break;case"skewx":r=r.map(function(e){return{x:e.x+Math.tan(n[0]*Math.PI/180)*e.y,y:e.y}});break;case"skewy":r=r.map(function(e){return{x:e.x,y:e.y+Math.tan(n[0]*Math.PI/180)*e.x}})}}}),r}function splitD(e){for(var t=/M|m|L|l|H|h|V|v|C|c|S|s|Q|q|T|t|A|a|Z|z/g,r=e.replace(t," $& ").replace(/([^e])(-\d(\d*\.?)\d*)/g,"$1 $2 ").split(/,| /).filter(function(e){return e}),a="M",n=[],i=0;i<r.length;){var s=[];if(r[i].match(t)?(s[0]=r[i].trim(),a=s[0],i++):s[0]=a,s[0].match(/Z|z/));else if(s[0].match(/V|v|H|h/))s=s.concat(r.slice(i,i+1)),i+=1;else if(s[0].match(/M|m|L|l|T|t/))s=s.concat(r.slice(i,i+2)),i+=2;else if(s[0].match(/Q|q|S|s/))s=s.concat(r.slice(i,i+4)),i+=4;else if(s[0].match(/C|c/))s=s.concat(r.slice(i,i+6)),i+=6;else{if(!s[0].match(/A|a/))break;s=s.concat(r.slice(i,i+7)),i+=7}n.push(s)}return n}function serializeSvgString(e){var t=serializeSvg(e);return(new XMLSerializer).serializeToString(t)}function serializeSvg(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=1,a=1;return e.forEach(function(e){t.appendChild(serializePath(e.d,e.style)),e.d.forEach(function(e){r=Math.max(r,e.x),a=Math.max(a,e.y)})}),r*=1.1,a*=1.1,t.setAttribute("width",""+r),t.setAttribute("height",""+a),t}function serializePath(e,t){var r=document.createElementNS("http://www.w3.org/2000/svg","path");return r.setAttribute("d",serializePointList(e)),r.setAttribute("style",serializeStyle(t)),r}function serializePointList(e){var t="";return e.forEach(function(r,a){0===a?t+="M "+r.x+","+r.y:(t+=" L "+r.x+","+r.y,a===e.length-1&&(t+=" Z"))}),t}function createStyle(){return{fill:!1,fillGlobalAlpha:1,fillStyle:"",lineCap:"butt",lineDash:[],lineJoin:"bevel",lineWidth:1,stroke:!1,strokeGlobalAlpha:1,strokeStyle:""}}function parseTagStyle(e){var t=createStyle(),r={},a=e.getAttributeNode("style");a?a.value.split(";").forEach(function(e){var t=e.split(":");2===t.length&&(r[t[0].trim()]=t[1].trim())}):e.getAttributeNames().forEach(function(t){var a=e.getAttributeNode(t);a&&(r[a.name]=a.value)});return Object.keys(r).forEach(function(e){e=e.toLowerCase();var a=r[e];if("fill"===e)"none"===a?(t.fillStyle="",t.fill=!1):(t.fillStyle=a,t.fill=!0);else if("stroke"===e)"none"===a?(t.strokeStyle="",t.stroke=!1):(t.strokeStyle=a,t.stroke=!0);else if("stroke-width"===e)t.lineWidth=parseFloat(a);else if("stroke-opacity"===e)t.strokeGlobalAlpha=parseFloat(a);else if("fill-opacity"===e)t.fillGlobalAlpha=parseFloat(a);else if("stroke-linecap"===e)t.lineCap=a;else if("stroke-linejoin"===e)t.lineJoin=a;else if("stroke-dasharray"===e)if("none"===a.toLowerCase())t.lineDash=[];else{var n=a.split(",");t.lineDash=[],n.forEach(function(e){t.lineDash.push(parseFloat(e))})}}),t}function serializeStyle(e){var t="";return e.fill?t+="fill:"+e.fillStyle+";":t+="fill:none;",e.fillGlobalAlpha&&(t+="fill-opacity:"+e.fillGlobalAlpha+";"),e.stroke?t+="stroke:"+e.strokeStyle+";":t+="stroke:none;",e.lineWidth&&(t+="stroke-width:"+e.lineWidth+";"),e.strokeGlobalAlpha&&(t+="stroke-opacity:"+e.strokeGlobalAlpha+";"),e.lineCap&&(t+="stroke-linecap:"+e.lineCap+";"),e.lineJoin&&(t+="stroke-linejoin:"+e.lineJoin+";"),e.lineDash&&(e.lineDash.length>0?t+="stroke-dasharray:"+e.lineDash.join(",")+";":t+="stroke-dasharray:none;"),t}var svg=Object.freeze({configs:configs,draw:draw,fitRect:fitRect,parseSvgGraphicsStr:parseSvgGraphicsStr,parseSvgGraphics:parseSvgGraphics,openCommandToD:openCommandToD,parseOpenPath:parseOpenPath,parsePathD:parsePathD,parsePath:parsePath,parseRect:parseRect,parseEllipse:parseEllipse,parseCircle:parseCircle,adoptTransform:adoptTransform,splitD:splitD,serializeSvgString:serializeSvgString,serializeSvg:serializeSvg,serializePath:serializePath,serializePointList:serializePointList,createStyle:createStyle,parseTagStyle:parseTagStyle,serializeStyle:serializeStyle}),okageo={geo:geo,svg:svg};module.exports=okageo;
//# sourceMappingURL=okageo.min.js.map
